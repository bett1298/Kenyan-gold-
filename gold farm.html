<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Video Clips | Professional Showcase</title>

  <!-- Font Awesome CDN -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary-color: #4361ee;
      --primary-hover: #3a56d4;
      --secondary-color: #7209b7;
      --accent-color: #f72585;
      --youtube-red: #ff0000;
      --youtube-red-hover: #cc0000;
      --success-color: #4cc9f0;
      --success-hover: #3ab0d6;
      --text-dark: #1a1a2e;
      --text-medium: #2d3047;
      --text-light: #6c757d;
      --bg-white: #ffffff;
      --bg-light: #f8f9fa;
      --bg-lighter: #f1f3f9;
      --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      --card-shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.12);
      --border-radius: 16px;
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
      margin: 0;
      padding: 0;
      color: var(--text-medium);
      line-height: 1.6;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    header {
      text-align: center;
      margin-bottom: 40px;
      padding: 20px 0;
    }

    .logo {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 15px;
    }

    .logo i {
      font-size: 32px;
      color: var(--primary-color);
      margin-right: 12px;
    }

    .logo h1 {
      font-size: 28px;
      font-weight: 700;
      color: var(--text-dark);
      letter-spacing: -0.5px;
    }

    .subtitle {
      font-size: 18px;
      color: var(--text-light);
      font-weight: 400;
      max-width: 600px;
      margin: 0 auto;
    }

    .clips-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 30px;
      margin-bottom: 40px;
    }

    .clip-card {
      background: var(--bg-white);
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      overflow: hidden;
      transition: var(--transition);
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .clip-card:hover {
      transform: translateY(-8px);
      box-shadow: var(--card-shadow-hover);
    }

    .thumbnail-container {
      position: relative;
      width: 100%;
      height: 200px;
      overflow: hidden;
    }

    .thumbnail {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: var(--transition);
    }

    .clip-card:hover .thumbnail {
      transform: scale(1.05);
    }

    .play-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: var(--transition);
    }

    .clip-card:hover .play-overlay {
      opacity: 1;
    }

    .play-icon {
      width: 60px;
      height: 60px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary-color);
      font-size: 24px;
      transition: var(--transition);
    }

    .clip-card:hover .play-icon {
      background: var(--primary-color);
      color: white;
      transform: scale(1.1);
    }

    .video-player {
      width: 100%;
      border-radius: 0;
      margin-bottom: 0;
    }

    .card-content {
      padding: 20px;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    .card-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 10px;
      line-height: 1.4;
    }

    .card-description {
      color: var(--text-light);
      font-size: 14px;
      margin-bottom: 20px;
      flex-grow: 1;
    }

    .card-stats {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      font-size: 14px;
      color: var(--text-light);
    }

    .likes-count {
      display: flex;
      align-items: center;
      margin-right: 15px;
    }

    .likes-count i {
      margin-right: 5px;
      color: var(--accent-color);
    }

    .comments-count {
      display: flex;
      align-items: center;
    }

    .comments-count i {
      margin-right: 5px;
      color: var(--success-color);
    }

    .card-actions {
      display: flex;
      gap: 10px;
      margin-top: auto;
    }

    .action-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      font-weight: 500;
      font-size: 14px;
      cursor: pointer;
      transition: var(--transition);
    }

    .like-btn {
      background: var(--bg-lighter);
      color: var(--text-medium);
    }

    .like-btn:hover {
      background: #e9ecef;
      transform: translateY(-2px);
    }

    .like-btn.liked {
      background: var(--accent-color);
      color: white;
    }

    .youtube-btn {
      background: var(--youtube-red);
      color: white;
    }

    .youtube-btn:hover {
      background: var(--youtube-red-hover);
      transform: translateY(-2px);
    }

    .youtube-btn i {
      margin-right: 8px;
      font-size: 16px;
    }

    .comments-section {
      margin-top: 20px;
      border-top: 1px solid #eaeaea;
      padding-top: 20px;
    }

    .comments-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 15px;
      color: var(--text-dark);
    }

    .comment-input-container {
      display: flex;
      margin-bottom: 20px;
    }

    .comment-input {
      flex: 1;
      padding: 12px 15px;
      border: 1px solid #e0e0e0;
      border-radius: 8px 0 0 8px;
      font-family: 'Inter', sans-serif;
      font-size: 14px;
      transition: var(--transition);
    }

    .comment-input:focus {
      outline: none;
      border-color: var(--primary-color);
    }

    .comment-submit {
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 0 8px 8px 0;
      padding: 0 20px;
      cursor: pointer;
      transition: var(--transition);
    }

    .comment-submit:hover {
      background: var(--primary-hover);
    }

    .comments-list {
      max-height: 200px;
      overflow-y: auto;
    }

    .comment {
      background: var(--bg-lighter);
      padding: 12px 15px;
      border-radius: 8px;
      margin-bottom: 10px;
      font-size: 14px;
    }

    .reply-section {
      margin-top: 8px;
      display: flex;
    }

    .reply-input {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #e0e0e0;
      border-radius: 6px 0 0 6px;
      font-size: 13px;
    }

    .reply-submit {
      background: var(--success-color);
      color: white;
      border: none;
      border-radius: 0 6px 6px 0;
      padding: 0 15px;
      cursor: pointer;
      font-size: 13px;
      transition: var(--transition);
    }

    .reply-submit:hover {
      background: var(--success-hover);
    }

    .replies {
      margin-top: 8px;
      padding-left: 15px;
    }

    .reply {
      background: rgba(255, 255, 255, 0.7);
      padding: 8px 12px;
      border-radius: 6px;
      margin-bottom: 6px;
      font-size: 13px;
      color: var(--text-light);
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: var(--text-light);
      font-style: italic;
    }

    .error {
      text-align: center;
      color: #dc3545;
      background: #f8d7da;
      padding: 15px;
      border-radius: 8px;
      margin: 20px auto;
      max-width: 600px;
    }

    footer {
      text-align: center;
      padding: 30px 0;
      color: var(--text-light);
      font-size: 14px;
      border-top: 1px solid #eaeaea;
      margin-top: 40px;
    }

    @media (max-width: 768px) {
      .clips-grid {
        grid-template-columns: 1fr;
      }
      
      .card-actions {
        flex-direction: column;
      }
      
      .comment-input-container {
        flex-direction: column;
      }
      
      .comment-input {
        border-radius: 8px;
        margin-bottom: 10px;
      }
      
      .comment-submit {
        border-radius: 8px;
        padding: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <i class="fas fa-play-circle"></i>
        <h1>Video Clips</h1>
      </div>
      <p class="subtitle">Discover and engage with our latest video content. Like, comment, and share your thoughts!</p>
    </header>

    <div class="clips-grid" id="clipsList">
      <div class="loading">Loading clips...</div>
    </div>

    <footer>
      <p>&copy; 2023 Video Clips Platform. All rights reserved.</p>
    </footer>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
    import { getDatabase, ref, onValue, update, push } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-database.js";

    // Firebase configuration - replace with your actual config
    const firebaseConfig = {
      apiKey: "AIzaSyDUYnN3bOTPNHvKHdWwrlACOAnLCAgxiJI",
      authDomain: "manuu-59b30.firebaseapp.com",
      databaseURL: "https://manuu-59b30-default-rtdb.firebaseio.com/",
      projectId: "manuu-59b30",
      storageBucket: "manuu-59b30.firebasestorage.app",
      messagingSenderId: "872309397811",
      appId: "1:872309397811:web:ebe13952c02b7394954646",
      measurementId: "G-Z33JK3J3FM"
    };

    // YouTube channel URL - replace with your actual channel
    const YOUTUBE_CHANNEL_URL = "https://www.youtube.com/@candle-o1p";

    try {
      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);
      const clipsRef = ref(db, "clips");

      function renderClips() {
        onValue(clipsRef, (snapshot) => {
          const clipsList = document.getElementById("clipsList");
          
          if (!snapshot.exists()) {
            clipsList.innerHTML = '<div class="error">No clips found. Add some clips to your database.</div>';
            return;
          }
          
          clipsList.innerHTML = "";

          snapshot.forEach((clipSnap) => {
            const clip = clipSnap.val();
            const clipId = clipSnap.key;

            // Skip clips without required data
            if (!clip.title || !clip.videoUrl) {
              console.warn(`Clip ${clipId} is missing required data`);
              return;
            }

            const div = document.createElement("div");
            div.classList.add("clip-card");

            div.innerHTML = `
              <div class="thumbnail-container">
                ${clip.imageUrl ? `<img src="${clip.imageUrl}" alt="Thumbnail" class="thumbnail">` : ''}
                <div class="play-overlay">
                  <div class="play-icon">
                    <i class="fas fa-play"></i>
                  </div>
                </div>
              </div>
              <video class="video-player" controls src="${clip.videoUrl}" style="display: none;"></video>
              <div class="card-content">
                <h3 class="card-title">${clip.title}</h3>
                ${clip.description ? `<p class="card-description">${clip.description}</p>` : ''}
                
                <div class="card-stats">
                  <div class="likes-count">
                    <i class="fas fa-heart"></i>
                    <span>${clip.likes || 0}</span>
                  </div>
                  <div class="comments-count">
                    <i class="fas fa-comment"></i>
                    <span>${clip.comments ? Object.keys(clip.comments).length : 0}</span>
                  </div>
                </div>
                
                <div class="card-actions">
                  <button class="action-btn like-btn" onclick="likeClip('${clipId}', ${clip.likes || 0}, this)">
                    <i class="fas fa-thumbs-up"></i> Like
                  </button>
                  <button class="action-btn youtube-btn" onclick="window.open('${YOUTUBE_CHANNEL_URL}', '_blank')">
                    <i class="fab fa-youtube"></i> Subscribe
                  </button>
                </div>
                
                <div class="comments-section">
                  <h4 class="comments-title">Comments</h4>
                  <div class="comment-input-container">
                    <input type="text" class="comment-input" id="comment-${clipId}" placeholder="Write a comment...">
                    <button class="comment-submit" onclick="addComment('${clipId}')">
                      <i class="fas fa-paper-plane"></i>
                    </button>
                  </div>
                  <div class="comments-list" id="comments-${clipId}"></div>
                </div>
              </div>
            `;

            // Add click event to thumbnail to toggle video
            const thumbnailContainer = div.querySelector('.thumbnail-container');
            const videoPlayer = div.querySelector('.video-player');
            
            thumbnailContainer.addEventListener('click', function() {
              if (videoPlayer.style.display === 'none') {
                videoPlayer.style.display = 'block';
                thumbnailContainer.style.display = 'none';
                videoPlayer.play();
              }
            });

            clipsList.appendChild(div);
            loadComments(clipId);
          });
        }, (error) => {
          console.error("Error loading clips:", error);
          document.getElementById("clipsList").innerHTML = 
            '<div class="error">Failed to load clips. Please check your connection and try again.</div>';
        });
      }

      window.likeClip = function (clipId, currentLikes, button) {
        try {
          update(ref(db, "clips/" + clipId), { likes: currentLikes + 1 });
          
          // Visual feedback
          button.classList.add('liked');
          button.innerHTML = '<i class="fas fa-check"></i> Liked';
          
          setTimeout(() => {
            button.classList.remove('liked');
            button.innerHTML = '<i class="fas fa-thumbs-up"></i> Like';
          }, 1000);
        } catch (error) {
          console.error("Error liking clip:", error);
        }
      };

      window.addComment = function (clipId) {
        try {
          const input = document.getElementById(`comment-${clipId}`);
          if (!input.value.trim()) return;
          push(ref(db, `clips/${clipId}/comments`), { 
            text: input.value, 
            timestamp: Date.now(),
            replies: [] 
          });
          input.value = "";
        } catch (error) {
          console.error("Error adding comment:", error);
        }
      };

      function loadComments(clipId) {
        const commentsRef = ref(db, `clips/${clipId}/comments`);
        onValue(commentsRef, (snapshot) => {
          const commentsDiv = document.getElementById("comments-" + clipId);
          commentsDiv.innerHTML = "";
          
          if (!snapshot.exists()) {
            commentsDiv.innerHTML = '<p style="text-align: center; color: var(--text-light); font-style: italic;">No comments yet. Be the first to comment!</p>';
            return;
          }
          
          snapshot.forEach((commentSnap) => {
            const comment = commentSnap.val();
            const commentId = commentSnap.key;

            const cdiv = document.createElement("div");
            cdiv.classList.add("comment");
            cdiv.innerHTML = `
              <div>${comment.text}</div>
              <div class="reply-section">
                <input type="text" class="reply-input" id="reply-${clipId}-${commentId}" placeholder="Write a reply...">
                <button class="reply-submit" onclick="addReply('${clipId}', '${commentId}')">
                  <i class="fas fa-reply"></i>
                </button>
              </div>
              <div class="replies" id="replies-${clipId}-${commentId}"></div>
            `;
            commentsDiv.appendChild(cdiv);

            if (comment.replies) {
              Object.values(comment.replies).forEach(reply => {
                const rdiv = document.createElement("div");
                rdiv.classList.add("reply");
                rdiv.innerText = reply;
                cdiv.querySelector(`#replies-${clipId}-${commentId}`).appendChild(rdiv);
              });
            }
          });
        });
      }

      window.addReply = function (clipId, commentId) {
        try {
          const input = document.getElementById(`reply-${clipId}-${commentId}`);
          if (!input.value.trim()) return;
          const repliesRef = ref(db, `clips/${clipId}/comments/${commentId}/replies`);
          push(repliesRef, input.value);
          input.value = "";
        } catch (error) {
          console.error("Error adding reply:", error);
        }
      };

      renderClips();
    } catch (error) {
      console.error("Firebase initialization error:", error);
      document.getElementById("clipsList").innerHTML = 
        '<div class="error">Failed to initialize the app. Please check your Firebase configuration.</div>';
    }
  </script>
</body>
  </html>
